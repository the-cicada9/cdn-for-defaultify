(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();function d(i){return new Promise((e,o)=>{const n=document.createElement("script");n.src=i,n.onload=()=>e(i),n.onerror=t=>o(`Error loading script: ${i}`),document.body.appendChild(n)})}async function x(){try{console.log("Loading html2canvas..."),await d("https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"),console.log("html2canvas loaded!"),console.log("Loading Fabric.js..."),await d("https://cdn.jsdelivr.net/npm/fabric@6.4.3/dist/index.js"),console.log("Fabric.js loaded!"),console.log("Loading JSZip..."),await d("https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"),console.log("JSZip loaded!"),await d("https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"),C.runSdk()}catch(i){console.error("Error loading scripts:",i)}}x();const C={runSdk(){T(),E()}};let y="",w="";function I(){return fetch("https://bmrtapplicationdev.appskeeper.in/v1/sessions/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appToken:"0f4365b8-a41d-41c3-80d9-b23bc6e2594f",deviceToken:"qwe123"})}).then(o=>o.json()).then(o=>{const n=o.result.token;console.log(n,">>>accesstoken");const t="https://bmrtapplicationdev.appskeeper.in/v1/issues",s={appInfo:{minSdk:"21",targetSdk:"30",isDebugMode:!0,debuggerAttach:!1,packageId:"com.example.app",locale:"en_US",buildFlavour:"release",versionCode:"123",versionName:"1.2.3"},deviceInfo:{name:"Pixel 4a",manufacturer:"Google",model:"Pixel 4a",deviceId:"12345abcdef",deviceVersion:"Android 12"},platform:{isRooted:!1,os:"iOS"},dimensions:{width:"1080",height:"2340",scale:"3.0",dpi_x:"400",dpi_y:"400",density:"2.75",density_dpi:"420"},type:"bug",email:"user@example.com",accessToken:n,appToken:"0f4365b8-a41d-41c3-80d9-b23bc6e2594f",video:"https://example.com/video.mp4",screenshot:"https://example.com/screenshot.png",shortSummary:"App crashes when clicking the button",description:"The app crashes immediately after clicking the button on the main screen.",trackingSdkVersion:"2.1.0",totalDuration:"5m30s",createdAt:"2024-11-08T10:30:00.000Z",uploadedAt:"2024-11-08T10:33:12.624Z"};return fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(s)})}).then(o=>o.json()).then(o=>{console.log("Issue created successfully",o);const n=o.result.url,t=o.result.name;return console.log(n,">>>URL for zip file"),{urlForZipFile:n,idIssue:t}}).catch(o=>{console.error("Error:",o)})}function E(){const i=document.getElementById("def-camera"),e=document.getElementById("def-img"),o=document.getElementById("def-ui");i.addEventListener("click",function(){i.textContent==="Capture"?(I(),i.style.visibility="hidden",o.style.backgroundColor="white",html2canvas(document.querySelector("body"),{allowTaint:!0,useCORS:!0,height:window.innerHeight,width:window.innerWidth,x:window.scrollX,y:window.scrollY}).then(n=>{const t=n.toDataURL(),s=h(t);e.src=t,e.style.opacity="1",i.style.visibility="visible",o.style.backgroundColor="gray",e.addEventListener("click",function(){S(e.src)}),sendToAPI(s,"")}),i.textContent="Cancel"):i.textContent==="Cancel"&&(e.style.opacity="0",i.textContent="Capture")})}function S(i){const e=document.createElement("div");e.id="modal",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="black",e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="1000";const o=document.createElement("img");o.id="modalImage",o.src=i,o.style.maxWidth="90%",o.style.maxHeight="80%",o.style.objectFit="contain",o.style.position="absolute";const n=document.createElement("canvas");n.id="canvasElement",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.zIndex="10",e.appendChild(o),e.appendChild(n);const t=document.createElement("button");t.id="submit-btn",t.textContent="Submit",t.style.position="absolute",t.style.padding="10px",t.style.backgroundColor="#fff",t.style.border="none",t.style.cursor="pointer",t.style.top="20px",t.style.right="20px",t.style.borderRadius="5px",t.style.zIndex="20",e.appendChild(t);const s=document.createElement("textarea");s.id="desc",s.style.width="60%",s.style.marginTop="90px",s.style.padding="10px",s.style.fontSize="14px",s.style.borderRadius="5px",s.style.border="1px solid #ccc",s.placeholder="Write description...",e.appendChild(s),document.getElementById("canvas-container").appendChild(e);const a=new fabric.Canvas(n);a.isDrawingMode=!0,a.freeDrawingBrush=new fabric.PencilBrush(a),a.freeDrawingBrush.width=5,a.freeDrawingBrush.color="#000000",o.onload=function(){a.setWidth(o.width),a.setHeight(o.height),a.renderAll()},a.on("path:created",function(){const p=a.toDataURL();console.log(p,">>>new")}),t.addEventListener("click",function(){t.style.display="none",html2canvas(e).then(function(p){const g=p.toDataURL("image/png"),f=h(g),b=s.value;console.log(b,">>>desc");const v={metadata:{batteryInfo:[{isCharging:!0,lowPowerMode:!0,batteryPercentage:"75%",capturedAt:"2024-11-08T10:33:12.624Z",duration:"15m"}],network:[{type:"Wi-Fi",status:"connected",rssi:"-60dBm",ssid:"MyWiFiNetwork",bssid:"00:14:22:01:23:45",mcc:"310",mnc:"260",name:"Home Wi-Fi",networkCountryCode:"US",simCountryCode:"US",phoneType:"Smartphone",capturedAt:"2024-11-08T10:33:15.000Z",duration:"5m"}],deviceOrientation:[{value:"portrait",capturedAt:"2024-11-08T10:33:20.000Z",duration:"10m"}],applicationState:[{value:"foreground",capturedAt:"2024-11-08T10:33:25.000Z",duration:"7m"}],multiWindow:[{value:!1,capturedAt:"2024-11-08T10:33:30.000Z",duration:"5m"}],topView:[{value:"com.example.app.MainActivity",capturedAt:"2024-11-08T10:33:35.000Z",duration:"6m"}],cpuUtilization:[{value:"18%",capturedAt:"2024-11-08T10:33:40.000Z",duration:"5m"}],flash:[{capturedAt:"2024-11-08T10:33:45.000Z",memory:"30MB",unit:"MB"}],memory:[{capturedAt:"2024-11-08T10:33:50.000Z",memory:"1.8GB",unit:"GB"}],bluetooth:[{isConnected:!0,name:"Bluetooth Speaker",capturedAt:"2024-11-08T10:33:12.624Z",duration:"15m"}]}};var c=new JSZip;c.file("snapshot.jpeg",f),c.file("meta.json",JSON.stringify(v)),console.log(c,">>> zip object"),console.log(y,"url_for_zip_file"),c.generateAsync({type:"blob"}).then(function(u){console.log(u,">>> generated zip content");const m=new File([u],`${w}`,{type:"application/zip"});console.log(m,">>> created zip file"),fetch(y,{method:"PUT",body:m}).then(r=>r.json()).then(r=>{console.log("API Response:",r),t.style.display="block"}).catch(r=>{console.error("Error uploading ZIP:",r),t.style.display="block"}),k()})})})}function k(){const i=document.getElementById("modal"),e=document.getElementById("canvas-container"),o=document.getElementById("def-img"),n=document.getElementById("def-camera"),t=document.getElementById("def-ui"),s=document.getElementById("modalImage"),l=document.getElementById("canvasElement");l&&l.remove(),i&&i.remove(),s&&s.remove(),e&&e.remove(),document.body.appendChild(e),document.body.appendChild(t),t.appendChild(n),document.body.appendChild(o),n.textContent="Capture"}function T(){const i=document.createElement("div"),e=document.createElement("button"),o=document.createElement("img"),n=document.createElement("div");o.id="def-img",e.id="def-camera",i.id="def-ui",n.id="canvas-container",e.textContent="Capture",e.style.color="black",e.style.fontSize="16px",e.style.fontWeight="400",e.style.backgroundColor="white",e.style.width="80%",e.style.height="80%",e.style.position="relative",e.style.top="50%",e.style.left="50%",e.style.borderRadius="6px",e.style.border="none",e.style.transform="translate(-50%, -50%)",e.style.cursor="pointer",e.style.zIndex="100",i.style.position="fixed",i.style.bottom="16px",i.style.right="16px",i.style.width="120px",i.style.height="60px",i.style.backgroundColor="black",i.style.borderRadius="10px",i.style.zIndex="100",i.style.background="gray",o.style.position="fixed",o.style.width="24vw",o.style.height="30vh",o.style.objectFit="contain",o.style.right="16px",o.style.bottom="80px",o.style.borderRadius="12px",o.style.opacity="0",o.style.background="gray",o.style.zIndex="100",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.zIndex="10",document.body.appendChild(n),document.body.appendChild(i),i.appendChild(e),document.body.appendChild(o)}function h(i){const e=atob(i.split(",")[1]),o=new Uint8Array(e.length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);const n=i.split(";")[0].split(":")[1];return new Blob([o],{type:n})}
